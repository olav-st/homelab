extraEnv: |
  - name: KEYCLOAK_ADMIN
    value: admin
  - name: KEYCLOAK_ADMIN_PASSWORD
    valueFrom:
      secretKeyRef:
        name: keycloak-admin-password
        key: pazzword
  - name: KC_HOSTNAME_STRICT
    value: "false"
  - name: KC_PROXY
    value: edge
  - name: KC_HTTP_ENABLED
    value: "true"

resources:
  requests:
    cpu: 500m
    memory: 1024Mi
  limits:
    memory: 3072Mi

ingress:
  enabled: true
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt
    traefik.ingress.kubernetes.io/router.entrypoints: websecure, webpublic
  rules:
    - host: keycloak.homelab.olav.ninja
      paths:
        - path: /
          pathType: Prefix
  tls:
    - hosts:
        - keycloak.homelab.olav.ninja
      secretName: keycloak-tls-secret

postgresql:
  enabled: true
  auth:
    existingSecret: keycloak-db-credentials
    secretKeys:
      adminPasswordKey: postgres-password
      userPasswordKey: password
      replicationPasswordKey: replication-password
  primary:
    persistence:
      enabled: false

service:
  type: ClusterIP
  httpPort: 8080
